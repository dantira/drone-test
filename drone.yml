name: drone-test
kind: pipeline
type: docker

steps:
- name: testvar
  image: alpine:3.8
  environment:
    SSH_KEY:
      from_secret: DEPLOY_KEY

- name: test
  image: plugins/ansible:3.0
  settings:
    playbook: .ansible/playbook.yml
    inventory: .ansible/inventory.yml
    become: true
    ssh_extra_args: "-o StrictHostKeyChecking=no"
    extra_vars:
      from_secret: ANSIBLE_EXTRA_VARS
    private_key:
      from_secret: DEPLOY_KEY


