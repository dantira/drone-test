name: drone-test
kind: pipeline
type: docker



steps:
- name: testvar
  image: alpine:3.8

- name: test
  image: plugins/ansible:3.0
  secrets:
    - source: ansible_private_key
      target: ssh_key
  settings:
    playbook: .ansible/playbook.yml
    inventory: .ansible/inventory.yml
    become: true
    ssh_extra_args: "-o StrictHostKeyChecking=no"
#    extra_vars:
#      from_secret: ANSIBLE_EXTRA_VARS
    private_key:
      from_secret: $ssh_key


